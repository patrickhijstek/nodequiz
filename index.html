<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <script src="/socket.io/socket.io.js"></script>
	<link rel="styleSheet" type="text/css" href="http://localhost/css/style.css">
    <script src="http://localhost/js/jquery-2.2.4.min.js"></script>
    <script src="http://localhost/js/app.js"></script>
    <script>
        var socket = io();
        var playerName;
        var gameId;
        var games;
        jQuery(document).ready(function(){
            $(document).on("click", "#start", function(e){
                e.preventDefault();
                playerName = $('[name="playername"]').val();
                socket.emit('join lobby', { name: playerName });
                lobbyPage();
            });

            $(document).on('click', ".NieuweSpel", function(e){
                e.preventDefault();
                $.get("http://localhost/unique_id.php", function (data) {
                    var gameid = data;
                    socket.emit('start game', { gameid: gameid });
                    nieuwSpel(playerName);
                })
                        .fail(function () {
                            alert("error");
                        });
            });

            $(document).on('click', ".gameList .game", function(e){
                e.preventDefault();
                socket.emit('join game', { name: playerName, gameid: $(this).attr('data-game') });
            });

            socket.on('show games', function (data) {
                games = jQuery.parseJSON(data);
                setTimeout(function(){
                    Object.keys(games).forEach(function(key) {
                        jQuery('.gameList').append('<li><a class="game" href="#" data-game="' + key + '">spel ' + key + '</a></li>');
                    });
                },100);
            });

            socket.on('game started', function (data) {
                gameId = data.gameId;
            });

            socket.on('both ready', function (data) {
                console.log(data);
                joinSpel(data.player1, playerName);
            });
        });
    </script>
	<title>NodeQuiz - Start </title>
</head>
<body>
	<main id="data"></main>
</body>
</html>